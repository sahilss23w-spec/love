<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<title>Itna Na Mujhse Tu Pyaar Badha | Sakura Bloom</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  overflow:hidden;
  background:#fff0f5;
  font-family:'Playfair Display',serif;
}

/* =========================
   GAME LANDSCAPE WRAPPER
   ========================= */
#game-wrapper{
  position:fixed;
  top:50%;
  left:50%;
  width:100vh;
  height:100vw;
  transform:translate(-50%,-50%) rotate(90deg);
  transform-origin:center;
  overflow:hidden;
  background:#fff0f5;
}

/* VIDEO */
#bg-video{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:-2;
}

/* CURTAINS */
.curtain{
  position:absolute;
  top:0;
  width:50%;
  height:100%;
  background:#000;
  z-index:9999;
  transition:transform 4s cubic-bezier(.45,0,.55,1);
}
#close-left{left:0;transform:translateX(-100%)}
#close-right{right:0;transform:translateX(100%)}
.curtain.active{transform:translateX(0)}

/* END MESSAGE */
#end-message{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  color:white;
  font-size:clamp(1.5rem,4vw,3rem);
  z-index:10000;
  opacity:0;
  pointer-events:none;
  transition:opacity 2s ease 3s;
}

/* OVERLAY */
.bg-overlay{
  position:absolute;
  inset:0;
  background:rgba(255,255,255,.12);
  z-index:0;
  pointer-events:none;
}

#nature-canvas{
  position:absolute;
  inset:0;
  z-index:1;
  pointer-events:none;
}

/* START */
#start-overlay{
  position:absolute;
  inset:0;
  background:#fff5f7;
  z-index:100;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:opacity 2s ease;
}
#start-overlay h1{
  color:#ff69b4;
  letter-spacing:8px;
  font-size:clamp(.9rem,3vw,1.2rem);
  animation:breathe 3s infinite;
}

@keyframes breathe{
  0%,100%{opacity:.3;transform:scale(.95)}
  50%{opacity:1;transform:scale(1)}
}

/* CONTENT */
.content-area{
  position:absolute;
  inset:0;
  z-index:10;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding-bottom:12%;
  text-align:center;
}

.lyric-line{
  font-size:clamp(1.8rem,6vw,4.5rem);
  color:#ff1493;
  font-style:italic;
  max-width:90%;
  text-shadow:2px 2px 10px rgba(255,255,255,.9);
}

.char{
  display:inline-block;
  opacity:0;
  filter:blur(10px);
  transform:translateY(20px) scale(.8);
  transition:all 1.4s cubic-bezier(.175,.885,.32,1.1);
  will-change:transform,opacity;
}
.char.visible{
  opacity:1;
  filter:blur(0);
  transform:none;
}
.char.exit{
  opacity:0;
  filter:blur(6px);
  transform:translateY(-30px) scale(1.05);
}

audio{display:none}
</style>
</head>

<body>

<div id="game-wrapper">

  <video id="bg-video" autoplay muted loop playsinline>
    <source src="bg.mp4" type="video/mp4">
  </video>

  <div id="start-overlay"><h1>Tap to Bloom</h1></div>

  <div id="close-left" class="curtain"></div>
  <div id="close-right" class="curtain"></div>
  <div id="end-message">The End</div>

  <div class="bg-overlay"></div>
  <canvas id="nature-canvas"></canvas>

  <div class="content-area">
    <div id="lyric" class="lyric-line"></div>
  </div>

  <audio id="song">
    <source src="l.mp4" type="audio/mp4">
  </audio>

</div>

<script>
/* LYRICS */
const lyricData=[
{time:0,text:"O nil gagan ke divaane"},
{time:4,text:"Tu pyaar na meraa pahachaane"},
{time:7,text:"Mai tab tak saath chalun tere"},
{time:11,text:"Jab tak na kahe tu mai haaraa"},
{time:15,text:"Is liye tujhase pyaar karu"},
{time:18,text:"Ke tu ek baadal avaaraa"},
{time:22,text:"Janam janam se hu saath tere"},
{time:25,text:"Ke naam meraa jal ki dhaaraa"},
{time:29,text:"Itanaa na mujhase tu pyaar badhaa"},
{time:33,text:"Ke mai ek baadal aavaaraa"},
{time:36,text:"Kaise kisi kaa sahaaraa banun"},
{time:39,text:"Ke mai khud beghar bechaaraa"}
];

const song=document.getElementById("song");
const lyricEl=document.getElementById("lyric");
const startOverlay=document.getElementById("start-overlay");
const leftCurtain=document.getElementById("close-left");
const rightCurtain=document.getElementById("close-right");
const endMsg=document.getElementById("end-message");

let lastIndex=-1,hasClosed=false;

function renderText(text){
  lyricEl.querySelectorAll(".char").forEach(c=>c.classList.add("exit"));
  setTimeout(()=>{
    lyricEl.innerHTML="";
    text.split("").forEach((ch,i)=>{
      const s=document.createElement("span");
      s.textContent=ch===" "?"\u00A0":ch;
      s.className="char";
      s.style.transitionDelay=`${i*45}ms`;
      lyricEl.appendChild(s);
      requestAnimationFrame(()=>s.classList.add("visible"));
    });
  },600);
}

/* PARTICLES */
const canvas=document.getElementById("nature-canvas");
const ctx=canvas.getContext("2d");
let petals=[];

function initParticles(){
  canvas.width=window.innerHeight;
  canvas.height=window.innerWidth;
  petals=[];
  let count=24;
  for(let i=0;i<count;i++){
    petals.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height,
      r:Math.random()*6+3,
      s:Math.random()*.4+.3,
      color:`rgba(255,${180+Math.random()*40},${200+Math.random()*20},.7)`
    });
  }
}

let lastFrame=0;
function draw(ts){
  if(ts-lastFrame<33){requestAnimationFrame(draw);return;}
  lastFrame=ts;

  ctx.clearRect(0,0,canvas.width,canvas.height);
  petals.forEach(p=>{
    p.y+=p.s;
    p.x+=Math.sin(p.y/80);
    if(p.y>canvas.height)p.y=-20;
    ctx.fillStyle=p.color;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  });
  requestAnimationFrame(draw);
}

function triggerClose(){
  if(hasClosed)return;
  hasClosed=true;
  leftCurtain.classList.add("active");
  rightCurtain.classList.add("active");
  endMsg.style.opacity=1;
}

startOverlay.onclick=()=>{
  startOverlay.style.opacity=0;
  setTimeout(()=>startOverlay.remove(),2000);
  song.play();
  initParticles();
  requestAnimationFrame(draw);
};

song.ontimeupdate=()=>{
  let t=song.currentTime,i=-1;
  for(let j=0;j<lyricData.length;j++)
    if(t>=lyricData[j].time)i=j;

  if(i!==-1&&i!==lastIndex){
    renderText(lyricData[i].text);
    lastIndex=i;
  }

  if(song.duration&&song.duration-t<.5)triggerClose();
};
song.onended=triggerClose;
</script>

</body>
</html>
